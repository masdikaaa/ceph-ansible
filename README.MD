# ğŸš€ Ceph Cluster Deployment with Ansible

<p align="center">
  <img src="https://img.shields.io/badge/Ansible-Automation-red?logo=ansible&logoColor=white" alt="Ansible" />
  <img src="https://img.shields.io/badge/Ceph-Storage-blue?logo=ceph&logoColor=white" alt="Ceph" />
  <img src="https://img.shields.io/badge/Podman-Container-lightgrey?logo=podman&logoColor=white" alt="Podman" />
  <img src="https://img.shields.io/badge/HAProxy-Load%20Balancer-green?logo=haproxy&logoColor=white" alt="HAProxy" />
  <img src="https://img.shields.io/badge/AWS%20CLI-Integration-orange?logo=amazonaws&logoColor=white" alt="AWS CLI" />
</p>

ğŸ“¦ **ceph-ansible** adalah playbook Ansible untuk **deploy cluster Ceph 3 node (ceph-1, ceph-2, ceph-3)** lengkap dengan **Rados Gateway (S3-compatible)** dan **HAProxy** sebagai load balancer.

---

## ğŸ“‚ Struktur Direktori

```bash
ceph-ansible/
â”œâ”€â”€ group_vars
â”‚   â””â”€â”€ all.yml                # Variabel global cluster
â”œâ”€â”€ inventory
â”‚   â””â”€â”€ hosts.ini              # Daftar host (ceph-1, ceph-2, ceph-3)
â”œâ”€â”€ roles
â”‚   â”œâ”€â”€ common                 # Install paket dasar (chrony, lvm2, dll)
â”‚   â”œâ”€â”€ cephadm_install        # Install cephadm & pull image Ceph
â”‚   â”œâ”€â”€ ceph_bootstrap         # Bootstrap cluster dari ceph-1
â”‚   â”œâ”€â”€ ceph_add_hosts         # Tambah node ceph-2 & ceph-3
â”‚   â”œâ”€â”€ ceph_services          # Deploy mon, mgr, osd
â”‚   â”œâ”€â”€ ceph_osd               # Setup OSD di setiap node
â”‚   â”œâ”€â”€ ceph_rgw               # Setup RGW (Rados Gateway)
â”‚   â””â”€â”€ haproxy                # Setup HAProxy (endpoint tunggal)
â””â”€â”€ site.yml                   # Entry point playbook
```

---

## âš™ï¸ Prasyarat

* ğŸ§ Ubuntu 22.04 LTS (disarankan)
* ğŸ™ Ansible sudah terinstall di **node ansible**
* ğŸ”‘ Akses SSH ke semua node (root/password)
* ğŸ“¡ Internet untuk pull image Ceph & install paket

---

## ğŸš€ Cara Pakai

### 1ï¸âƒ£ Clone Repo

```bash
git clone https://github.com/username/ceph-ansible.git
cd ceph-ansible
```

### 2ï¸âƒ£ Konfigurasi Inventory

Edit file `inventory/hosts.ini`:

```ini
[ceph_nodes]
ceph-1 ansible_host=103.168.146.210 ansible_user=root ansible_password=yourpass
ceph-2 ansible_host=103.168.146.206 ansible_user=root ansible_password=yourpass
ceph-3 ansible_host=103.168.146.207 ansible_user=root ansible_password=yourpass
```

### 3ï¸âƒ£ Jalankan Playbook

```bash
ansible-playbook -i inventory/hosts.ini site.yml
```

---

## ğŸ”‘ Akses Dashboard

Setelah bootstrap berhasil, dashboard bisa diakses di:

```
https://103.168.146.210:8443/
```

Login default:

* **User**: `root`
* **Password**: `Andikaferdi11`

---

## ğŸŒ HAProxy Endpoint

Setelah role HAProxy jalan, endpoint S3 bisa diakses via:

```
http://103.168.146.210:7480
```

---

## ğŸª£ Contoh Setup User S3

```bash
radosgw-admin user create --uid="andika" --display-name="Andika"
```

Catat **access\_key** dan **secret\_key** untuk AWS CLI.

---

## ğŸ³ Test AWS CLI

```bash
aws configure
# Access Key ID: dari radosgw-admin
# Secret Access Key: dari radosgw-admin
# Region: us-east-1
# Output: json

aws --endpoint-url http://103.168.146.210:7480 s3 mb s3://test-bucket
aws --endpoint-url http://103.168.146.210:7480 s3 cp /etc/hosts s3://test-bucket/
aws --endpoint-url http://103.168.146.210:7480 s3 ls s3://test-bucket
```

---

## ğŸ¯ Tujuan Project

âœ… Automasi full deployment Ceph cluster dengan Ansible.
âœ… S3-compatible object storage via RGW.
âœ… Load balancing dengan HAProxy.
âœ… Dokumentasi lengkap agar mudah dipahami pemula.

---

## ğŸ“œ Lisensi

Proyek ini dirilis di bawah [MIT License](./LICENSE).
